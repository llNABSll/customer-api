{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:27:33+0000", "level": "ERROR", "logger": "app.core.database", "msg": "db session rolled back due to exception", "service": "customer-api", "request_id": "594d67978a45437f82131492e1f226a9", "exc_info": "Traceback (most recent call last):\n  File \"/app/app/core/database.py\", line 54, in get_db\n    yield db\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/concurrency.py\", line 27, in contextmanager_in_threadpool\n    yield await run_in_threadpool(cm.__enter__)\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 302, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 215, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2476, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/api/routes.py\", line 68, in list_customers\n    rows = svc.list(\n           ^^^^^^^^^\nTypeError: CustomerService.list() got an unexpected keyword argument 'q'"}
{"ts": "2025-09-08T21:27:33+0000", "level": "ERROR", "logger": "uvicorn.error", "msg": "Exception in ASGI application\n", "service": "customer-api", "request_id": "-", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 183, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 772, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py\", line 409, in run_asgi\n    |     result = await app(  # type: ignore[func-returns-value]\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py\", line 60, in __call__\n    |     return await self.app(scope, receive, send)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/fastapi/applications.py\", line 1054, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/applications.py\", line 113, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 186, in __call__\n    |     raise exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/app/app/main.py\", line 96, in metrics_middleware\n    |     response: Response = await call_next(request)\n    |                          ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    |     raise app_exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/app/app/core/logging.py\", line 164, in access_log_middleware\n    |     response: Response = await call_next(request)\n    |                          ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    |     raise app_exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 78, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 75, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 302, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 215, in run_endpoint_function\n    |     return await run_in_threadpool(dependant.call, **values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    |     return await anyio.to_thread.run_sync(func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    |     return await get_async_backend().run_sync_in_worker_thread(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2476, in run_sync_in_worker_thread\n    |     return await future\n    |            ^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 967, in run\n    |     result = context.run(func, *args)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/app/app/api/routes.py\", line 68, in list_customers\n    |     rows = svc.list(\n    |            ^^^^^^^^^\n    | TypeError: CustomerService.list() got an unexpected keyword argument 'q'\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py\", line 409, in run_asgi\n    result = await app(  # type: ignore[func-returns-value]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py\", line 60, in __call__\n    return await self.app(scope, receive, send)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/applications.py\", line 113, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 186, in __call__\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/main.py\", line 96, in metrics_middleware\n    response: Response = await call_next(request)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/core/logging.py\", line 164, in access_log_middleware\n    response: Response = await call_next(request)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 302, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 215, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2476, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/api/routes.py\", line 68, in list_customers\n    rows = svc.list(\n           ^^^^^^^^^\nTypeError: CustomerService.list() got an unexpected keyword argument 'q'"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:07+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:08+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:08+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:08+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:08+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:08+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:39:24+0000", "level": "ERROR", "logger": "app.core.database", "msg": "db session rolled back due to exception", "service": "customer-api", "request_id": "eec751eb8bf64ca398ee7dfd427b7084", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\npsycopg2.errors.UndefinedColumn: column clients.created_at does not exist\nLINE 1: ... clients_company, clients.phone AS clients_phone, clients.cr...\n                                                             ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/core/database.py\", line 54, in get_db\n    yield db\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/concurrency.py\", line 27, in contextmanager_in_threadpool\n    yield await run_in_threadpool(cm.__enter__)\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 302, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 215, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2476, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/api/routes.py\", line 69, in list_customers\n    rows = svc.list(\n           ^^^^^^^^^\n  File \"/app/app/services/client_service.py\", line 77, in list\n    return query.offset(skip).limit(limit).all()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 2704, in all\n    return self._iter().all()  # type: ignore\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1419, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column clients.created_at does not exist\nLINE 1: ... clients_company, clients.phone AS clients_phone, clients.cr...\n                                                             ^\n\n[SQL: SELECT clients.id AS clients_id, clients.name AS clients_name, clients.email AS clients_email, clients.company AS clients_company, clients.phone AS clients_phone, clients.created_at AS clients_created_at, clients.updated_at AS clients_updated_at, clients.version AS clients_version \nFROM clients ORDER BY clients.id \n LIMIT %(param_1)s OFFSET %(param_2)s]\n[parameters: {'param_1': 10, 'param_2': 0}]\n(Background on this error at: https://sqlalche.me/e/20/f405)"}
{"ts": "2025-09-08T21:39:24+0000", "level": "ERROR", "logger": "uvicorn.error", "msg": "Exception in ASGI application\n", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\npsycopg2.errors.UndefinedColumn: column clients.created_at does not exist\nLINE 1: ... clients_company, clients.phone AS clients_phone, clients.cr...\n                                                             ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py\", line 409, in run_asgi\n    result = await app(  # type: ignore[func-returns-value]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py\", line 60, in __call__\n    return await self.app(scope, receive, send)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/applications.py\", line 113, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 186, in __call__\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/main.py\", line 96, in metrics_middleware\n    response: Response = await call_next(request)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/core/logging.py\", line 164, in access_log_middleware\n    response: Response = await call_next(request)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 302, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 215, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2476, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/api/routes.py\", line 69, in list_customers\n    rows = svc.list(\n           ^^^^^^^^^\n  File \"/app/app/services/client_service.py\", line 77, in list\n    return query.offset(skip).limit(limit).all()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 2704, in all\n    return self._iter().all()  # type: ignore\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1419, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column clients.created_at does not exist\nLINE 1: ... clients_company, clients.phone AS clients_phone, clients.cr...\n                                                             ^\n\n[SQL: SELECT clients.id AS clients_id, clients.name AS clients_name, clients.email AS clients_email, clients.company AS clients_company, clients.phone AS clients_phone, clients.created_at AS clients_created_at, clients.updated_at AS clients_updated_at, clients.version AS clients_version \nFROM clients ORDER BY clients.id \n LIMIT %(param_1)s OFFSET %(param_2)s]\n[parameters: {'param_1': 10, 'param_2': 0}]\n(Background on this error at: https://sqlalche.me/e/20/f405)"}
{"ts": "2025-09-08T21:43:38+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "edf50211a5e24c3ba8b5418c63d8d56d"}
{"ts": "2025-09-08T21:43:38+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Published rk='%s' payload=%s", "service": "customer-api", "request_id": "edf50211a5e24c3ba8b5418c63d8d56d"}
{"ts": "2025-09-08T21:43:38+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "edf50211a5e24c3ba8b5418c63d8d56d"}
{"ts": "2025-09-08T21:43:38+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "edf50211a5e24c3ba8b5418c63d8d56d"}
{"ts": "2025-09-08T21:45:10+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:47:00+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:38+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:53:43+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "a348a4ba5c1a4a888fbe6b3f2945f065"}
{"ts": "2025-09-08T21:53:43+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Published rk='%s' payload=%s", "service": "customer-api", "request_id": "a348a4ba5c1a4a888fbe6b3f2945f065"}
{"ts": "2025-09-08T21:53:43+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "a348a4ba5c1a4a888fbe6b3f2945f065"}
{"ts": "2025-09-08T21:53:43+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "a348a4ba5c1a4a888fbe6b3f2945f065"}
{"ts": "2025-09-08T21:58:51+0000", "level": "ERROR", "logger": "aiormq.connection", "msg": "Unexpected connection close from remote \"%s\", Connection.Close(reply_code=%r, reply_text=%r)", "service": "customer-api", "request_id": "-", "exc_info": "NoneType: None"}
{"ts": "2025-09-08T21:58:51+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to %s closed. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:58:51+0000", "level": "ERROR", "logger": "aio_pika.tools", "msg": "Callback %r error", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/tools.py\", line 306, in __task_inner\n    await self.callback(*args, **kwargs)\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 119, in _on_close\n    await self.restore()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 94, in restore\n    await self.reopen()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 132, in reopen\n    await super().reopen()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/channel.py\", line 244, in reopen\n    await self._open()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/channel.py\", line 173, in _open\n    channel = await UnderlayChannel.create(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/abc.py\", line 485, in create\n    channel = await connection.channel(**kwargs)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aiormq/connection.py\", line 918, in channel\n    raise RuntimeError(\"%r closed\" % self)\nRuntimeError: <Connection: \"amqp://app:******@rabbitmq:5672/%2F\" at 0x7f5584f1eb20> closed"}
{"ts": "2025-09-08T21:58:51+0000", "level": "ERROR", "logger": "aio_pika.tools", "msg": "Callback %r error", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/tools.py\", line 306, in __task_inner\n    await self.callback(*args, **kwargs)\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 119, in _on_close\n    await self.restore()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 94, in restore\n    await self.reopen()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 132, in reopen\n    await super().reopen()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/channel.py\", line 244, in reopen\n    await self._open()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/channel.py\", line 169, in _open\n    raise ChannelInvalidStateError(\"No active transport in channel\")\naiormq.exceptions.ChannelInvalidStateError: No active transport in channel"}
{"ts": "2025-09-08T21:58:51+0000", "level": "ERROR", "logger": "aiormq.connection", "msg": "error when creating transport: %r", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:58:51+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to %s closed. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:58:51+0000", "level": "WARNING", "logger": "aio_pika.robust_connection", "msg": "Connection attempt to \"%s\" failed: %s. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:04+0000", "level": "ERROR", "logger": "aiormq.connection", "msg": "error when creating transport: %r", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:04+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to %s closed. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:04+0000", "level": "WARNING", "logger": "aio_pika.robust_connection", "msg": "Connection attempt to \"%s\" failed: %s. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:08+0000", "level": "ERROR", "logger": "aiormq.connection", "msg": "error when creating transport: %r", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:08+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to %s closed. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:08+0000", "level": "WARNING", "logger": "aio_pika.robust_connection", "msg": "Connection attempt to \"%s\" failed: %s. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:13+0000", "level": "ERROR", "logger": "aiormq.connection", "msg": "error when creating transport: %r", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:13+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to %s closed. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:13+0000", "level": "WARNING", "logger": "aio_pika.robust_connection", "msg": "Connection attempt to \"%s\" failed: %s. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:17+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:17+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:17+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:17+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:17+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:53+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "46df3276027347099b633b1150364f72"}
{"ts": "2025-09-08T22:00:53+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Published rk='%s' payload=%s", "service": "customer-api", "request_id": "46df3276027347099b633b1150364f72"}
{"ts": "2025-09-08T22:00:53+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "46df3276027347099b633b1150364f72"}
{"ts": "2025-09-08T22:00:53+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "46df3276027347099b633b1150364f72"}
{"ts": "2025-09-08T22:03:01+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:05:59+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "6549b4c0460f402ca37d2b9813ab250d"}
{"ts": "2025-09-08T22:05:59+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Published rk='%s' payload=%s", "service": "customer-api", "request_id": "6549b4c0460f402ca37d2b9813ab250d"}
{"ts": "2025-09-08T22:05:59+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "6549b4c0460f402ca37d2b9813ab250d"}
{"ts": "2025-09-08T22:05:59+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "6549b4c0460f402ca37d2b9813ab250d"}
{"ts": "2025-09-08T22:06:10+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:07:35+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "a506900b2b25431390bad75c3228b489"}
{"ts": "2025-09-08T22:07:35+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Published rk='%s' payload=%s", "service": "customer-api", "request_id": "a506900b2b25431390bad75c3228b489"}
{"ts": "2025-09-08T22:07:35+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "a506900b2b25431390bad75c3228b489"}
{"ts": "2025-09-08T22:07:35+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "a506900b2b25431390bad75c3228b489"}
{"ts": "2025-09-08T22:07:41+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:33:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:33:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:33:33+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:33:33+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:33:33+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to amqp://guest:******@rabbitmq:5672/%2F closed. Reconnecting after 5 seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:33:33+0000", "level": "ERROR", "logger": "customer-api", "msg": "RabbitMQ startup failed", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/aiormq/abc.py\", line 44, in __inner\n    return await self.task\n           ^^^^^^^^^^^^^^^\nasyncio.exceptions.CancelledError\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/main.py\", line 51, in lifespan\n    await rabbitmq.connect()\n  File \"/app/app/infra/events/rabbitmq.py\", line 40, in connect\n    self.connection = await aio_pika.connect_robust(self.url)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_connection.py\", line 340, in connect_robust\n    await connection.connect(timeout=timeout)\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_connection.py\", line 186, in connect\n    await self.__fail_fast_future\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_connection.py\", line 141, in __connection_factory\n    await Connection.connect(self, self.__connect_timeout)\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/connection.py\", line 118, in connect\n    self.transport = await UnderlayConnection.connect(\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/abc.py\", line 671, in connect\n    connection = await cls.make_connection(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/abc.py\", line 659, in make_connection\n    connection: aiormq.abc.AbstractConnection = await asyncio.wait_for(\n                                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/asyncio/tasks.py\", line 452, in wait_for\n    return await fut\n           ^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aiormq/connection.py\", line 920, in connect\n    await connection.connect(client_properties or {})\n  File \"/usr/local/lib/python3.11/site-packages/aiormq/base.py\", line 164, in wrap\n    return await self.create_task(func(self, *args, **kwargs))\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aiormq/abc.py\", line 46, in __inner\n    raise self._exception from e\n  File \"/usr/local/lib/python3.11/asyncio/tasks.py\", line 694, in _wrap_awaitable\n    return (yield from awaitable.__await__())\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aiormq/abc.py\", line 46, in __inner\n    raise self._exception from e\n  File \"/usr/local/lib/python3.11/site-packages/aiormq/connection.py\", line 484, in connect\n    frame = await self._rpc(\n            ^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aiormq/connection.py\", line 436, in _rpc\n    raise ProbableAuthenticationError(frame.reply_text)\naiormq.exceptions.ProbableAuthenticationError: ACCESS_REFUSED - Login was refused using authentication mechanism PLAIN. For details see the broker logfile."}
{"ts": "2025-09-09T10:33:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:33:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:37:18+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:37:19+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:37:19+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:37:19+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:27+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:27+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:27+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:27+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:27+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:28+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:28+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:28+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:28+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:32+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "09f50e3dd16f4214a5f6cc0a509a5f28", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('John Doe', 'john.doe@test.com', 'Doe Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T10:38:33+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "b42b7eb964e4412dbf91e513e470077d", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T10:38:34+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "7baa580c8d73444a9b821f2a0a24cb6e", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Alice', 'alice@test.com', 'A Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T10:38:34+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "29ab6f85f9cf4a5b971018262f652e01", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Lifecycle User', 'lifecycle@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T10:38:35+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "f40ed650fa244510bd6dbc21b80c9672"}
{"ts": "2025-09-09T10:38:35+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:35+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:35+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:35+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:36+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "03d5012d561140ca9dba8109cae21fa3"}
{"ts": "2025-09-09T10:38:36+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:36+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:36+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:36+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:36+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:36+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:36+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:36+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:36+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T10:38:36+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T11:31:29+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:31:29+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to amqp://app:******@rabbitmq:5672/%2F closed. Reconnecting after 5 seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:31:29+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:31:29+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:31:29+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:31:29+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:31:29+0000", "level": "INFO", "logger": "aio_pika.queue", "msg": "<RobustQueueIterator: queue='q-customer' ctag='ctag2.9b1dc38c2b3f46d8aa6bc5845939bb55'> closing with timeout 5 seconds", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:10+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "8dbe1e1f308a4bed8c21b9e800581c53", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('John Doe', 'john.doe@test.com', 'Doe Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:32:11+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "d5c11f65601b457eb655dadf3982526e", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:32:12+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "19c8eb37df08454c937fc3332308123d", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Alice', 'alice@test.com', 'A Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:32:13+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "b384df4511bd482f8e1c461710a996b1", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Lifecycle User', 'lifecycle@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:32:14+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "e6e2e8c47c3d4b7c9e62e1ad38e634b0"}
{"ts": "2025-09-09T11:32:14+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:14+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:14+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:14+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "8da7bbd34ce149e18488f2f9a1c4c41f"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:15+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:16+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:16+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:16+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:16+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:16+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:16+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:16+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:16+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:32:16+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:38:51+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:38:51+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:38:51+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:38:51+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:38:51+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:38:51+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:38:51+0000", "level": "INFO", "logger": "aio_pika.queue", "msg": "<RobustQueueIterator: queue='q-customer' ctag='ctag2.8f7bc4eec1c448edb45105ff2d37c0d0'> closing with timeout 5 seconds", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:36+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "8fc76747a412477e9e480353be011c97", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('John Doe', 'john.doe@test.com', 'Doe Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:39:37+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "851d1bda503e4bd18bbc7d71e952fde1", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:39:38+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "9d82b94a81924d98929ba02ce87b46e6", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Alice', 'alice@test.com', 'A Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:39:39+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "f71c87e1644147aca3fddbc6e629aa30", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Lifecycle User', 'lifecycle@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:39:40+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:40+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:40+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:40+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:40+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:40+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:40+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:40+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T11:39:41+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:41+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:41+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:44+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:44+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:44+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:44+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:44+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:44+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:44+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:44+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:39:44+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:40:50+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:40:50+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:40:50+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:40:50+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:40:50+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:40:50+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:40:50+0000", "level": "INFO", "logger": "aio_pika.queue", "msg": "<RobustQueueIterator: queue='q-customer' ctag='ctag2.83f32c2181f24530ad57a5ac15c1b0e4'> closing with timeout 5 seconds", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:52:59+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "4d7efc6b7bde46fa997669e3c736ff70", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('John Doe', 'john.doe@test.com', 'Doe Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:53:00+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "01a8c6306ebf482b9752310718f7aeb1", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:53:01+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "10360d7999424e8aa074ff69c7c9a47e", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Alice', 'alice@test.com', 'A Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:53:02+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "09b6c9bedf5e40d1933eb267de3dae6d", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Lifecycle User', 'lifecycle@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "9c649913450f4d3387e2767130618e41"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "fbaffdbd14de4da293ce906a7d577aef"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "3bfb437b3b234e19a8de6a45417279be"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:04+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:06+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:06+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:06+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:06+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:06+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:06+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:06+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:06+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:53:06+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:04+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:05+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:05+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:05+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:05+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:05+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:05+0000", "level": "INFO", "logger": "aio_pika.queue", "msg": "<RobustQueueIterator: queue='q-customer' ctag='ctag2.ae883b6f3cf346fcbbf5c588960e7961'> closing with timeout 5 seconds", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:40+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "bf34e21f96764bddb038a333ac3bba67", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('John Doe', 'john.doe@test.com', 'Doe Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:56:42+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "b037e695da754691b628498b39077dcc", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:56:42+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "c160029c9ac045a7abd3461386c62f08", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Alice', 'alice@test.com', 'A Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:56:43+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "6633bb1bd8df4d7eaac19c663125a208", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Lifecycle User', 'lifecycle@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T11:56:44+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "b8dd456189fc4cd3aa1cfc4dabf9ed1f"}
{"ts": "2025-09-09T11:56:44+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:44+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:44+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "c0222e34960e43dea0b931b1f6fd10eb"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "f565fb578f8b47eb8615f5f68076cca2"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 18, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:45+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:48+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:48+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:48+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:48+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:48+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:48+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:48+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:48+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T11:56:48+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:04:39+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:04:39+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:04:39+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:04:39+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:04:39+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:04:39+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:04:39+0000", "level": "INFO", "logger": "aio_pika.queue", "msg": "<RobustQueueIterator: queue='q-customer' ctag='ctag2.4837e35f07e243e2aa50dc8724bb56c0'> closing with timeout 5 seconds", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:17+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "2312c773aee84dbaacf87389170beb54", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('John Doe', 'john.doe@test.com', 'Doe Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T12:08:18+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "6982cbef5ae94f358ea563c5ca4446df", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T12:08:19+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "24644c1c4923433fa0fe316bb2c51dc7", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Alice', 'alice@test.com', 'A Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T12:08:21+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "505549568340420ab9ea97bfd13a8347", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Lifecycle User', 'lifecycle@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "57b3412e22b4436aa4f8ac2f55dc0753"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "2453f8d070a4478c86682c32808962ed"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "eddfa9f5c7a842be9007844ca8574ba2"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:22+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:24+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:24+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:24+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:24+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:25+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:25+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:25+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:25+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:08:25+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:14:40+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:14:40+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:14:40+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:14:40+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:14:40+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:14:40+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:14:40+0000", "level": "INFO", "logger": "aio_pika.queue", "msg": "<RobustQueueIterator: queue='q-customer' ctag='ctag2.7b79182181144e3c9510b92e78bc0de5'> closing with timeout 5 seconds", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "55018b344ddc4e3eafa16a199c49716c"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "55018b344ddc4e3eafa16a199c49716c"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "55018b344ddc4e3eafa16a199c49716c"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "99c66eb64f1d4cbaab071b4a112b6370"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "99c66eb64f1d4cbaab071b4a112b6370"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "99c66eb64f1d4cbaab071b4a112b6370"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:18+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "7c040c3ffa894b90a2a29b867bd232f7", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "c67efb87a853497a8b2736392b5af894"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "c67efb87a853497a8b2736392b5af894"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "c67efb87a853497a8b2736392b5af894"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "ef97a0acde6e49d6821467ae56e820c6"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "ef97a0acde6e49d6821467ae56e820c6"}
{"ts": "2025-09-09T12:15:18+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "ef97a0acde6e49d6821467ae56e820c6"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/?company=A%20Corp \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "02488c402ae1473d81d4715319fec87c"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "02488c402ae1473d81d4715319fec87c"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "02488c402ae1473d81d4715319fec87c"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "24c9d7573aa4485b9113e2962c018e68"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "24c9d7573aa4485b9113e2962c018e68"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "24c9d7573aa4485b9113e2962c018e68"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "8753d9f9071b4ac1a7ab0af3e88b0270"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "8753d9f9071b4ac1a7ab0af3e88b0270"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "8753d9f9071b4ac1a7ab0af3e88b0270"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "ab6ea3aab3a74e898971ba04868fe0ca"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "085043d233dd4e8d9aa430dca8db6564"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "dc1bd1e4b2384fd0a52920f81031e8b8"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:19+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:24+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:24+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:24+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:24+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:24+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:24+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:24+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:24+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:15:24+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:17:39+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:17:39+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:17:39+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:17:39+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:17:39+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:17:39+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:17:39+0000", "level": "INFO", "logger": "aio_pika.queue", "msg": "<RobustQueueIterator: queue='q-customer' ctag='ctag2.52ca604f7d9741358861eb93175390ba'> closing with timeout 5 seconds", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "ce2b7c07fc6f4851aafc226f6fdd8c5b"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "ce2b7c07fc6f4851aafc226f6fdd8c5b"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "ce2b7c07fc6f4851aafc226f6fdd8c5b"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "e5be47a1db36464487fffcb054f71cac"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "e5be47a1db36464487fffcb054f71cac"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "e5be47a1db36464487fffcb054f71cac"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "4a253ef40a234ad1adaa665d73c78d6d", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "be048c6d0d22413196579ece9059f0b1"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "be048c6d0d22413196579ece9059f0b1"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "be048c6d0d22413196579ece9059f0b1"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "e7b1d1d5009e4b2f983ab0de10a1181f"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "e7b1d1d5009e4b2f983ab0de10a1181f"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "e7b1d1d5009e4b2f983ab0de10a1181f"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/?company=A%20Corp \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "67c228d2551b45aeaf9b0eda4fd0c6a7"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "67c228d2551b45aeaf9b0eda4fd0c6a7"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "67c228d2551b45aeaf9b0eda4fd0c6a7"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "f5fa8f2568dc443699ec4b489de20e5b"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "f5fa8f2568dc443699ec4b489de20e5b"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "f5fa8f2568dc443699ec4b489de20e5b"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "d32d14c98c4f4e2cafc318decca4d2b6"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "d32d14c98c4f4e2cafc318decca4d2b6"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "d32d14c98c4f4e2cafc318decca4d2b6"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "1d376cfb32e04f63818ce16b2a5a7b97"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "3d38b4561be14cf39c9115fe065aeb7f"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "562bae25ea12467588ded5a6dc2daeb0"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:26+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:27+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:27+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:27+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:27+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:27+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:27+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:27+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:27+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T12:28:27+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:27+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:27+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:32+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:32+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:32+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:32+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:32+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:32+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:32+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:32+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:28:32+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:06+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "fd53f06477dd45bea2c63b43a2713bd7"}
{"ts": "2025-09-09T14:33:06+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "fd53f06477dd45bea2c63b43a2713bd7"}
{"ts": "2025-09-09T14:33:06+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "fd53f06477dd45bea2c63b43a2713bd7"}
{"ts": "2025-09-09T14:33:06+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:06+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "0f372bf2c17f4cf2874b79205b13b05c"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "0f372bf2c17f4cf2874b79205b13b05c"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "0f372bf2c17f4cf2874b79205b13b05c"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "2a7ff6297db64bffbc5237ed2f90b638", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "eea7deabcae94a4a879e30d27fd400d3"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "eea7deabcae94a4a879e30d27fd400d3"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "eea7deabcae94a4a879e30d27fd400d3"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "707a1e9887e64118b86ef63db5897652"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "707a1e9887e64118b86ef63db5897652"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "707a1e9887e64118b86ef63db5897652"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/?company=A%20Corp \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "dfdf92778b91460889ff9632fb2f325d"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "dfdf92778b91460889ff9632fb2f325d"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "dfdf92778b91460889ff9632fb2f325d"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "ac07a39d99f344ee84c940e642b09772"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "ac07a39d99f344ee84c940e642b09772"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "ac07a39d99f344ee84c940e642b09772"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "0a19f8a6fc1f43c397f622bae77cb858"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "0a19f8a6fc1f43c397f622bae77cb858"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "0a19f8a6fc1f43c397f622bae77cb858"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "eaf7cb903f1140959380b3d6ccf1ffa0"}
{"ts": "2025-09-09T14:33:07+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "db33e54c657c4b21b3e4a9449de87771"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "a3d74f5c551043078d3e011ada6cd8a6"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:08+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "0b4de911ce9940d99d8edf878c11b112"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "0b4de911ce9940d99d8edf878c11b112"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "0b4de911ce9940d99d8edf878c11b112"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "a7a1dca10eef4e52a88452289dc75edd"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "a7a1dca10eef4e52a88452289dc75edd"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "a7a1dca10eef4e52a88452289dc75edd"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:40+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "431608b4851c4ab7881e703430b0fec4", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "2da32e542f9648d2b8f9fa0a80f81566"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "2da32e542f9648d2b8f9fa0a80f81566"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "2da32e542f9648d2b8f9fa0a80f81566"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "6270469eb82c4e2b87a178b92e26b4bf"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "6270469eb82c4e2b87a178b92e26b4bf"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "6270469eb82c4e2b87a178b92e26b4bf"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/?company=A%20Corp \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "f8b4869a85d94542867a8a7bc2fc8c64"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "f8b4869a85d94542867a8a7bc2fc8c64"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "f8b4869a85d94542867a8a7bc2fc8c64"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:40+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "50d8b62b0be84e22913d1f3de2c16be4"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "50d8b62b0be84e22913d1f3de2c16be4"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "50d8b62b0be84e22913d1f3de2c16be4"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "f4972da9a71d432d9f15403c82b58efc"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "f4972da9a71d432d9f15403c82b58efc"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "f4972da9a71d432d9f15403c82b58efc"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "e263aaad5bba4955b708281c5b48cb15"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "f835fe4788e94f43af2f92866812fa73"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "0fddfecd47354cc18b71ef06b7199c99"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:33:41+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "8c1413a1d7094080bc2c75d80ca7bb48"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "8c1413a1d7094080bc2c75d80ca7bb48"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "8c1413a1d7094080bc2c75d80ca7bb48"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "0f68215af9824fd2a1174f73d5403525"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "0f68215af9824fd2a1174f73d5403525"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "0f68215af9824fd2a1174f73d5403525"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "0ea09f9bcc1f4f96ba0f876c02bab429", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "524440ebbb92434f95cd11e78a2a8ba9"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "524440ebbb92434f95cd11e78a2a8ba9"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "524440ebbb92434f95cd11e78a2a8ba9"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "33173d68eada4e2087174b6d9b006cc8"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "33173d68eada4e2087174b6d9b006cc8"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "33173d68eada4e2087174b6d9b006cc8"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/?company=A%20Corp \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "9d1b48266598496ea6d0e308e98952a2"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "9d1b48266598496ea6d0e308e98952a2"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "9d1b48266598496ea6d0e308e98952a2"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/4 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "3e587014b3424c169e2d311075896e02"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "3e587014b3424c169e2d311075896e02"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "3e587014b3424c169e2d311075896e02"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/4 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/4 \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "6b4218e3b09f49bda31a890ec5f1850c"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "6b4218e3b09f49bda31a890ec5f1850c"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "6b4218e3b09f49bda31a890ec5f1850c"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/4 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/4 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "2feb789478f7412285f713a9c3b040a4"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "c6377b95af2d4791bf79d4a94910e3a1"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "3fa627c6c0be4e32b0fa461373667ad2"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:09+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:10+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:10+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:10+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:10+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:34:10+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:10+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:10+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "53425f55e9ff478f8c611febfd373522"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "53425f55e9ff478f8c611febfd373522"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "53425f55e9ff478f8c611febfd373522"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "607e594fd2ce4518b48fa66029142a83"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "607e594fd2ce4518b48fa66029142a83"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "607e594fd2ce4518b48fa66029142a83"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "7bb1cc4ce1364b4a9582896abaf20454", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "9912b780bdaa486e80f61627e23053dd"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "9912b780bdaa486e80f61627e23053dd"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "9912b780bdaa486e80f61627e23053dd"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "4bfbf6c252734f59959bb9aad85e8492"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "4bfbf6c252734f59959bb9aad85e8492"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "4bfbf6c252734f59959bb9aad85e8492"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/?company=A%20Corp \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "bd607fa4531e43a080468fd6d4d07880"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "bd607fa4531e43a080468fd6d4d07880"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "bd607fa4531e43a080468fd6d4d07880"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "a3bd8cfa7f4d49d8b047cc572f0fdebb"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "a3bd8cfa7f4d49d8b047cc572f0fdebb"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "a3bd8cfa7f4d49d8b047cc572f0fdebb"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "ba08b607b0fd4d80a26323f0daf4dcf4"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "ba08b607b0fd4d80a26323f0daf4dcf4"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "ba08b607b0fd4d80a26323f0daf4dcf4"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "a14d1908842d4b6cb7394cb31467e2e1"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "f8c1f6f13fb54d09b72d2f40bf632deb"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "95694ec167fc4f2985efb2a661f40fa3"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:24+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:44+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "7c598abdcd164586bc8029ebc63ba9e9", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('John Doe', 'john.doe@test.com', 'Doe Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T14:34:45+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "0979ed3473e14459910171519f39059e", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T14:34:46+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "a2de91a1a93940048a1f081abc2df8e1", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Alice', 'alice@test.com', 'A Corp', None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T14:34:48+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "7ab1c0dae14a4fe799156914ac633744", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: clients\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: clients\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Lifecycle User', 'lifecycle@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "e708b7c910a34e75bdf80c5a5e769c95"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "6ab9753a8b03468abbb11eade5f3eec7"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "2c2b98cc06fa49e9bd9ea1d1c6b9e174"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:34:50+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "86866327a4e04e6aa8ec57986226f258"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "86866327a4e04e6aa8ec57986226f258"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "86866327a4e04e6aa8ec57986226f258"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "6fdfb95914c94cfe8df099c2f6254076"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "6fdfb95914c94cfe8df099c2f6254076"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "6fdfb95914c94cfe8df099c2f6254076"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "f28f10c102ce4beba2d381a68a02598d", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "f21631340904487f86a5b240454ec15a"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "f21631340904487f86a5b240454ec15a"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "f21631340904487f86a5b240454ec15a"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "bced5fa9211e4c1db17a55c4f500e167"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "bced5fa9211e4c1db17a55c4f500e167"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "bced5fa9211e4c1db17a55c4f500e167"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/?company=A%20Corp \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "bc8e63982f5e48c3877e334e5a77082d"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "bc8e63982f5e48c3877e334e5a77082d"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "bc8e63982f5e48c3877e334e5a77082d"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "7d6e1b5757784808b6ad0925cc3454f9"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "7d6e1b5757784808b6ad0925cc3454f9"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "7d6e1b5757784808b6ad0925cc3454f9"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:11+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "66547dd8071c4f0cbf828c34b04791d2"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "66547dd8071c4f0cbf828c34b04791d2"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "66547dd8071c4f0cbf828c34b04791d2"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "dbf0af0ec3434e1981146129e2234cdf"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "e3a3d9168b02465aaaed409d6730d756"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "4f69334f41e5426289d0fe866343fcfe"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\bpa\\Documents\\Documents_personnel_benjamin\\Cours\\mspr4\\customer-api\\app\\repositories\\client.py\", line 19, in create_client\n    db.commit()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"C:\\Users\\bpa\\AppData\\Local\\Programs\\Python\\Python310\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T14:35:12+0200", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:35:43+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:35:43+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:35:43+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:35:43+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:35:43+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:35:43+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:35:43+0000", "level": "INFO", "logger": "aio_pika.queue", "msg": "<RobustQueueIterator: queue='q-customer' ctag='ctag2.3d228febfb1f4203bd112519dca5e11f'> closing with timeout 5 seconds", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "82430e2ba69b462396b27a03ec0b63ab"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "82430e2ba69b462396b27a03ec0b63ab"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "82430e2ba69b462396b27a03ec0b63ab"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "58f530aca36c4d3082b0c1c833caa52e"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "58f530aca36c4d3082b0c1c833caa52e"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "58f530aca36c4d3082b0c1c833caa52e"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "9bf34b0e3b6647879f8da9e04148c3e6", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "76cf519d4938458c8df813702e02ea07"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "76cf519d4938458c8df813702e02ea07"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "76cf519d4938458c8df813702e02ea07"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "6f2430fad750443095b7fa757136dba4"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "6f2430fad750443095b7fa757136dba4"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "6f2430fad750443095b7fa757136dba4"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/?company=A%20Corp \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "1f383b0ee64542adb403dc51f024bfdf"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "1f383b0ee64542adb403dc51f024bfdf"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "1f383b0ee64542adb403dc51f024bfdf"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "6d0ca92a86e148fcbcf3833bf105b5b4"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "6d0ca92a86e148fcbcf3833bf105b5b4"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "6d0ca92a86e148fcbcf3833bf105b5b4"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "aa6fdaeca2b24d5d87f0d1abd72c39cb"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "aa6fdaeca2b24d5d87f0d1abd72c39cb"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "aa6fdaeca2b24d5d87f0d1abd72c39cb"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "b7c2e556a68a4abe87dcb59f4bdee387"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "c81f53fc571f41c4bf9de94e9acd9ee5"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "31f9509a45bd4e32b955f687b16c28dd"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:21+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:27+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:27+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:27+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:27+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:27+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:27+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:27+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:27+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:36:27+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:38:43+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:38:43+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:38:43+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:38:43+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:38:43+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:38:43+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:38:43+0000", "level": "INFO", "logger": "aio_pika.queue", "msg": "<RobustQueueIterator: queue='q-customer' ctag='ctag2.58cbf6b4eebe430fa8781426b18843c0'> closing with timeout 5 seconds", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "e245c9cc8ca342a9960cd24d7a904bd8"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "e245c9cc8ca342a9960cd24d7a904bd8"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "e245c9cc8ca342a9960cd24d7a904bd8"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "b4e84579668746f5b0191a954490721e"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "b4e84579668746f5b0191a954490721e"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "b4e84579668746f5b0191a954490721e"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "57f5a6b85e0740288cd8fae3b5e35bd5", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "cd582e51b907496a96271fc48556e2c2"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "cd582e51b907496a96271fc48556e2c2"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "cd582e51b907496a96271fc48556e2c2"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "c8309b7a7de14775a55b6dfb7144d991"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "c8309b7a7de14775a55b6dfb7144d991"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "c8309b7a7de14775a55b6dfb7144d991"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/?company=A%20Corp \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "da751d16bd9a4a879a7ab9dc94ff5655"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "da751d16bd9a4a879a7ab9dc94ff5655"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "da751d16bd9a4a879a7ab9dc94ff5655"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "2b3e51c427c844d28f0ff61033b4722e"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "2b3e51c427c844d28f0ff61033b4722e"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "2b3e51c427c844d28f0ff61033b4722e"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "80a0bba9b4c94219a5b9affde51761c5"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "80a0bba9b4c94219a5b9affde51761c5"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "80a0bba9b4c94219a5b9affde51761c5"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "2834f437b78b4f168bd7415b4e68554f"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "43aeb7d326bd469390a9d026cace8692"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "66691c2cca7e4df68a78d1516a099d09"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:41+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:42+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:42+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:42+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:42+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:42+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T12:58:42+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:42+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:42+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:47+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:47+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:47+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:47+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:47+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:47+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:47+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:47+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:58:47+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:59:07+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:59:07+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:59:07+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:59:07+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T12:59:07+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "174691e3e7cf4435b5423bdd38e84b56"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "174691e3e7cf4435b5423bdd38e84b56"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "174691e3e7cf4435b5423bdd38e84b56"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "9b635dc87c61445cbcd6e5180e72e0c9"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "9b635dc87c61445cbcd6e5180e72e0c9"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "9b635dc87c61445cbcd6e5180e72e0c9"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "3562af1ae3674de89556ed41e3438d70", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Jane Doe', 'jane.doe@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "88848cb6c11c4eb88e757667c0f9c490"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "88848cb6c11c4eb88e757667c0f9c490"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "88848cb6c11c4eb88e757667c0f9c490"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "4aee787a23b44d9bbce342b66a00f332"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "4aee787a23b44d9bbce342b66a00f332"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "4aee787a23b44d9bbce342b66a00f332"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/?company=A%20Corp \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "97926759c3494147a978305a6bfbc3b1"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "97926759c3494147a978305a6bfbc3b1"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "97926759c3494147a978305a6bfbc3b1"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "b68ee6d34a3f44ee9a60e70e8e01438a"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "b68ee6d34a3f44ee9a60e70e8e01438a"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "b68ee6d34a3f44ee9a60e70e8e01438a"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 409 Conflict\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "93ccfc274dc94f18b1f10e45ceb4bcff"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "93ccfc274dc94f18b1f10e45ceb4bcff"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "93ccfc274dc94f18b1f10e45ceb4bcff"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "bed9e8a0564c466697d47f16440be240"}
{"ts": "2025-09-09T13:03:08+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: POST http://testserver/customers/ \"HTTP/1.1 201 Created\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/ \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/99 \"HTTP/1.1 404 Not Found\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer updated", "service": "customer-api", "request_id": "dc07af4646384890b784f9c0a778c306"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: PUT http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer deleted", "service": "customer-api", "request_id": "6720322c72f34cbf9b9eb66ea1f653e7"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: DELETE http://testserver/customers/1 \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "httpx", "msg": "HTTP Request: GET http://testserver/customers/email/client@test.com \"HTTP/1.1 200 OK\"", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "ERROR", "logger": "app.repositories.client", "msg": "error creating client", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.IntegrityError: UNIQUE constraint failed: clients.email\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/repositories/client.py\", line 19, in create_client\n    db.commit()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: clients.email\n[SQL: INSERT INTO clients (name, email, company, phone, version) VALUES (?, ?, ?, ?, ?) RETURNING id, created_at, updated_at]\n[parameters: ('Dup', 'dup@test.com', None, None, 1)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer updated", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:09+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer deleted", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange 'events' (topic) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern product.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue q-customer bound to pattern order.#", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [1]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-09T13:03:15+0000", "level": "INFO", "logger": "aio_pika.queue", "msg": "<RobustQueueIterator: queue='q-customer' ctag='ctag2.a50f064614694682b48ecbd20af8a7f1'> closing with timeout 5 seconds", "service": "customer-api", "request_id": "-"}
