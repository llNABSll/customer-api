{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:26:18+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:27:33+0000", "level": "ERROR", "logger": "app.core.database", "msg": "db session rolled back due to exception", "service": "customer-api", "request_id": "594d67978a45437f82131492e1f226a9", "exc_info": "Traceback (most recent call last):\n  File \"/app/app/core/database.py\", line 54, in get_db\n    yield db\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/concurrency.py\", line 27, in contextmanager_in_threadpool\n    yield await run_in_threadpool(cm.__enter__)\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 302, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 215, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2476, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/api/routes.py\", line 68, in list_customers\n    rows = svc.list(\n           ^^^^^^^^^\nTypeError: CustomerService.list() got an unexpected keyword argument 'q'"}
{"ts": "2025-09-08T21:27:33+0000", "level": "ERROR", "logger": "uvicorn.error", "msg": "Exception in ASGI application\n", "service": "customer-api", "request_id": "-", "exc_info": "  + Exception Group Traceback (most recent call last):\n  |   File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 183, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 772, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py\", line 409, in run_asgi\n    |     result = await app(  # type: ignore[func-returns-value]\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py\", line 60, in __call__\n    |     return await self.app(scope, receive, send)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/fastapi/applications.py\", line 1054, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/applications.py\", line 113, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 186, in __call__\n    |     raise exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/app/app/main.py\", line 96, in metrics_middleware\n    |     response: Response = await call_next(request)\n    |                          ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    |     raise app_exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/app/app/core/logging.py\", line 164, in access_log_middleware\n    |     response: Response = await call_next(request)\n    |                          ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    |     raise app_exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 78, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 75, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 302, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 215, in run_endpoint_function\n    |     return await run_in_threadpool(dependant.call, **values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    |     return await anyio.to_thread.run_sync(func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    |     return await get_async_backend().run_sync_in_worker_thread(\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2476, in run_sync_in_worker_thread\n    |     return await future\n    |            ^^^^^^^^^^^^\n    |   File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 967, in run\n    |     result = context.run(func, *args)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/app/app/api/routes.py\", line 68, in list_customers\n    |     rows = svc.list(\n    |            ^^^^^^^^^\n    | TypeError: CustomerService.list() got an unexpected keyword argument 'q'\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py\", line 409, in run_asgi\n    result = await app(  # type: ignore[func-returns-value]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py\", line 60, in __call__\n    return await self.app(scope, receive, send)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/applications.py\", line 113, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 186, in __call__\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/main.py\", line 96, in metrics_middleware\n    response: Response = await call_next(request)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/core/logging.py\", line 164, in access_log_middleware\n    response: Response = await call_next(request)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 302, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 215, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2476, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/api/routes.py\", line 68, in list_customers\n    rows = svc.list(\n           ^^^^^^^^^\nTypeError: CustomerService.list() got an unexpected keyword argument 'q'"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:28:55+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:29:46+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:14+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:33:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:36:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:37:59+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:07+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:08+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:08+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:08+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:08+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:08+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:38:58+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:39:24+0000", "level": "ERROR", "logger": "app.core.database", "msg": "db session rolled back due to exception", "service": "customer-api", "request_id": "eec751eb8bf64ca398ee7dfd427b7084", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\npsycopg2.errors.UndefinedColumn: column clients.created_at does not exist\nLINE 1: ... clients_company, clients.phone AS clients_phone, clients.cr...\n                                                             ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/app/app/core/database.py\", line 54, in get_db\n    yield db\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/concurrency.py\", line 27, in contextmanager_in_threadpool\n    yield await run_in_threadpool(cm.__enter__)\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 302, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 215, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2476, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/api/routes.py\", line 69, in list_customers\n    rows = svc.list(\n           ^^^^^^^^^\n  File \"/app/app/services/client_service.py\", line 77, in list\n    return query.offset(skip).limit(limit).all()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 2704, in all\n    return self._iter().all()  # type: ignore\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1419, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column clients.created_at does not exist\nLINE 1: ... clients_company, clients.phone AS clients_phone, clients.cr...\n                                                             ^\n\n[SQL: SELECT clients.id AS clients_id, clients.name AS clients_name, clients.email AS clients_email, clients.company AS clients_company, clients.phone AS clients_phone, clients.created_at AS clients_created_at, clients.updated_at AS clients_updated_at, clients.version AS clients_version \nFROM clients ORDER BY clients.id \n LIMIT %(param_1)s OFFSET %(param_2)s]\n[parameters: {'param_1': 10, 'param_2': 0}]\n(Background on this error at: https://sqlalche.me/e/20/f405)"}
{"ts": "2025-09-08T21:39:24+0000", "level": "ERROR", "logger": "uvicorn.error", "msg": "Exception in ASGI application\n", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\npsycopg2.errors.UndefinedColumn: column clients.created_at does not exist\nLINE 1: ... clients_company, clients.phone AS clients_phone, clients.cr...\n                                                             ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py\", line 409, in run_asgi\n    result = await app(  # type: ignore[func-returns-value]\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py\", line 60, in __call__\n    return await self.app(scope, receive, send)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/applications.py\", line 113, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 186, in __call__\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/main.py\", line 96, in metrics_middleware\n    response: Response = await call_next(request)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 182, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"/usr/local/lib/python3.11/contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 184, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/core/logging.py\", line 164, in access_log_middleware\n    response: Response = await call_next(request)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 159, in call_next\n    raise app_exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/usr/local/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/usr/local/lib/python3.11/site-packages/starlette/routing.py\", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 302, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/fastapi/routing.py\", line 215, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/starlette/concurrency.py\", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2476, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/app/app/api/routes.py\", line 69, in list_customers\n    rows = svc.list(\n           ^^^^^^^^^\n  File \"/app/app/services/client_service.py\", line 77, in list\n    return query.offset(skip).limit(limit).all()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 2704, in all\n    return self._iter().all()  # type: ignore\n           ^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/orm/context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1419, in execute\n    return meth(\n           ^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 526, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1641, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 951, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column clients.created_at does not exist\nLINE 1: ... clients_company, clients.phone AS clients_phone, clients.cr...\n                                                             ^\n\n[SQL: SELECT clients.id AS clients_id, clients.name AS clients_name, clients.email AS clients_email, clients.company AS clients_company, clients.phone AS clients_phone, clients.created_at AS clients_created_at, clients.updated_at AS clients_updated_at, clients.version AS clients_version \nFROM clients ORDER BY clients.id \n LIMIT %(param_1)s OFFSET %(param_2)s]\n[parameters: {'param_1': 10, 'param_2': 0}]\n(Background on this error at: https://sqlalche.me/e/20/f405)"}
{"ts": "2025-09-08T21:43:38+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "edf50211a5e24c3ba8b5418c63d8d56d"}
{"ts": "2025-09-08T21:43:38+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Published rk='%s' payload=%s", "service": "customer-api", "request_id": "edf50211a5e24c3ba8b5418c63d8d56d"}
{"ts": "2025-09-08T21:43:38+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "edf50211a5e24c3ba8b5418c63d8d56d"}
{"ts": "2025-09-08T21:43:38+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "edf50211a5e24c3ba8b5418c63d8d56d"}
{"ts": "2025-09-08T21:45:10+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:47:00+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:49:33+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:50:10+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:51:25+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:11+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:52:38+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:53:43+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "a348a4ba5c1a4a888fbe6b3f2945f065"}
{"ts": "2025-09-08T21:53:43+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Published rk='%s' payload=%s", "service": "customer-api", "request_id": "a348a4ba5c1a4a888fbe6b3f2945f065"}
{"ts": "2025-09-08T21:53:43+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "a348a4ba5c1a4a888fbe6b3f2945f065"}
{"ts": "2025-09-08T21:53:43+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "a348a4ba5c1a4a888fbe6b3f2945f065"}
{"ts": "2025-09-08T21:58:51+0000", "level": "ERROR", "logger": "aiormq.connection", "msg": "Unexpected connection close from remote \"%s\", Connection.Close(reply_code=%r, reply_text=%r)", "service": "customer-api", "request_id": "-", "exc_info": "NoneType: None"}
{"ts": "2025-09-08T21:58:51+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to %s closed. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:58:51+0000", "level": "ERROR", "logger": "aio_pika.tools", "msg": "Callback %r error", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/tools.py\", line 306, in __task_inner\n    await self.callback(*args, **kwargs)\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 119, in _on_close\n    await self.restore()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 94, in restore\n    await self.reopen()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 132, in reopen\n    await super().reopen()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/channel.py\", line 244, in reopen\n    await self._open()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/channel.py\", line 173, in _open\n    channel = await UnderlayChannel.create(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/abc.py\", line 485, in create\n    channel = await connection.channel(**kwargs)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/aiormq/connection.py\", line 918, in channel\n    raise RuntimeError(\"%r closed\" % self)\nRuntimeError: <Connection: \"amqp://app:******@rabbitmq:5672/%2F\" at 0x7f5584f1eb20> closed"}
{"ts": "2025-09-08T21:58:51+0000", "level": "ERROR", "logger": "aio_pika.tools", "msg": "Callback %r error", "service": "customer-api", "request_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/tools.py\", line 306, in __task_inner\n    await self.callback(*args, **kwargs)\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 119, in _on_close\n    await self.restore()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 94, in restore\n    await self.reopen()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/robust_channel.py\", line 132, in reopen\n    await super().reopen()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/channel.py\", line 244, in reopen\n    await self._open()\n  File \"/usr/local/lib/python3.11/site-packages/aio_pika/channel.py\", line 169, in _open\n    raise ChannelInvalidStateError(\"No active transport in channel\")\naiormq.exceptions.ChannelInvalidStateError: No active transport in channel"}
{"ts": "2025-09-08T21:58:51+0000", "level": "ERROR", "logger": "aiormq.connection", "msg": "error when creating transport: %r", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:58:51+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to %s closed. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:58:51+0000", "level": "WARNING", "logger": "aio_pika.robust_connection", "msg": "Connection attempt to \"%s\" failed: %s. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:04+0000", "level": "ERROR", "logger": "aiormq.connection", "msg": "error when creating transport: %r", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:04+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to %s closed. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:04+0000", "level": "WARNING", "logger": "aio_pika.robust_connection", "msg": "Connection attempt to \"%s\" failed: %s. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:08+0000", "level": "ERROR", "logger": "aiormq.connection", "msg": "error when creating transport: %r", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:08+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to %s closed. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:08+0000", "level": "WARNING", "logger": "aio_pika.robust_connection", "msg": "Connection attempt to \"%s\" failed: %s. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:13+0000", "level": "ERROR", "logger": "aiormq.connection", "msg": "error when creating transport: %r", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:13+0000", "level": "INFO", "logger": "aio_pika.robust_connection", "msg": "Connection to %s closed. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:13+0000", "level": "WARNING", "logger": "aio_pika.robust_connection", "msg": "Connection attempt to \"%s\" failed: %s. Reconnecting after %r seconds.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:17+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:17+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:17+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:17+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T21:59:17+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Started server process [%d]", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application startup.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "customer-api", "msg": "database connection OK", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "app.core.database", "msg": "DB init: tables ensured", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connected. Exchange '%s' (%s) declared.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application startup complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Uvicorn running on %s://%s:%d (Press CTRL+C to quit)", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:03+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Queue %s bound to pattern %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:00:53+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "46df3276027347099b633b1150364f72"}
{"ts": "2025-09-08T22:00:53+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Published rk='%s' payload=%s", "service": "customer-api", "request_id": "46df3276027347099b633b1150364f72"}
{"ts": "2025-09-08T22:00:53+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "46df3276027347099b633b1150364f72"}
{"ts": "2025-09-08T22:00:53+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "46df3276027347099b633b1150364f72"}
{"ts": "2025-09-08T22:03:01+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:05:59+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "6549b4c0460f402ca37d2b9813ab250d"}
{"ts": "2025-09-08T22:05:59+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Published rk='%s' payload=%s", "service": "customer-api", "request_id": "6549b4c0460f402ca37d2b9813ab250d"}
{"ts": "2025-09-08T22:05:59+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "6549b4c0460f402ca37d2b9813ab250d"}
{"ts": "2025-09-08T22:05:59+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "6549b4c0460f402ca37d2b9813ab250d"}
{"ts": "2025-09-08T22:06:10+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:07:35+0000", "level": "INFO", "logger": "app.repositories.client", "msg": "client created", "service": "customer-api", "request_id": "a506900b2b25431390bad75c3228b489"}
{"ts": "2025-09-08T22:07:35+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "Published rk='%s' payload=%s", "service": "customer-api", "request_id": "a506900b2b25431390bad75c3228b489"}
{"ts": "2025-09-08T22:07:35+0000", "level": "INFO", "logger": "app.services.client_service", "msg": "customer created", "service": "customer-api", "request_id": "a506900b2b25431390bad75c3228b489"}
{"ts": "2025-09-08T22:07:35+0000", "level": "INFO", "logger": "app.api.routes", "msg": "customer created", "service": "customer-api", "request_id": "a506900b2b25431390bad75c3228b489"}
{"ts": "2025-09-08T22:07:41+0000", "level": "INFO", "logger": "customer-api", "msg": "[customer-api] received %s: %s", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Shutting down", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Waiting for application shutdown.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ channel closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "app.infra.events.rabbitmq", "msg": "RabbitMQ connection closed.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Application shutdown complete.", "service": "customer-api", "request_id": "-"}
{"ts": "2025-09-08T22:12:30+0000", "level": "INFO", "logger": "uvicorn.error", "msg": "Finished server process [%d]", "service": "customer-api", "request_id": "-"}
